{% load static %}
{% include 'dating/navbar.html' %}
{% load crispy_forms_tags %}

<!DOCTYPE html>
<html lang="en">
  <head>
        
            
    <title>Profile</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="{% static '/images/love.png'  %}">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="icon" href="{% static '/images/love.png'  %}">
    
    <link id="mystylesheet" rel="stylesheet" type="text/css" href="{% static '/css/lightprof.css'%}">

    

    
  </head>

  <body style="font-family: 'Montserrat', sans-serif">

    <div class="container">

            
      <div class="row align-items-center justify-content-center">

        <div class="card" style="width: 18rem; top: 50px;">
          <img src="{{ request.user.profile.profile_pic.url }}" class="card-img-top" alt="{{request.user.username}}">
          <div class="card-body">

            <h5 class="card-title" style="color: #FF416C;">{{request.user.username}} </h5>
            <h6 class="card-text"> {{request.user.profile.gender}} </h6>
             
            <h6 class="card-text"> {{request.user.profile.age}} </h6>
           
            <h6 class="card-text"> {{request.user.profile.state}} {{request.user.profile.country}} </h6>
            <h6 style="font-weight: 430;" class="app-p">{{request.user.profile.bio}} </h6>

           <br>
            <a href="{% url 'editprofile' %}" style=" color: white; text-decoration: none; outline: none;">
             <button class="btn btn-default  btn-block" type="submit" style=" background: #FF416C;background: -webkit-linear-gradient(to right, #FF4B2B, #FF416C);background: linear-gradient(to right, #FF4B2B, #FF416C);border:2px solid rgb(24, 26, 31);color: white; ">Edit profile
             </button>
            </a>           
          </div>

        </div>
      </div>

  	  <br>
      <br>
      <br>
        <button class="btn btn-light btn-block"  onclick="swapStyles('lightprof.css');">Light Mode</button>
        <button class="btn btn-dark btn-block" onclick="swapStyles('darkprof.css');">Dark Mode</button>

    </div>
  <script type="text/javascript">

  
  function getcookie(name){
    var cookievalue = null;
    if(document.cookie && document.cookie !== ''){
      var cookies = document.cookie.split(';');
      for (var i = 0; i < cookies.length; i++ ){
        var cookie = cookies[i].trim();

        if(cookie.substring(0, name.length + 1) === (name + '=')){
          cookievalue =  decodeURIComponent(cookie.substring(name.length + 1));
          break;   
        }
      }
    }

    return cookievalue;

  }

  var csrftoken = getcookie('csrftoken');

  var cssFile = "{% static '/css' %}"


  function swapStyles(sheet){
    document.getElementById('mystylesheet').href = cssFile + '/' + sheet
    localStorage.setItem('theme', sheet)  
    updatetheme(sheet)    

  }


  function localsettings(){


    var url = "{% url 'user_settings' %}"

    fetch(url, {
      method:'GET',
      headers : {
        'Content-type':'application/json'
      }
    })
    .then((response) => response.json())
    .then (function(data){

      console.log('theme:',data)

      var theme = data.value;

      if (theme == 'lightprof.css' || null){
        swapStyles('lightprof.css')
      }else{
        swapStyles('darkprof.css')
      }
    })   
  }

  localsettings()

  function updatetheme(theme){
    var url ="{%  url 'update_theme' %}"
    fetch(url,{
      method:'POST',
      headers:{
        'content-type':'application/json',
        'X-CSRFToken' : csrftoken,
      },
      body:JSON.stringify({'theme':theme})

    })
    
  }

 </script>

        
       

    

  </body>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
</html>